<!doctype html>
<html lang="de">
  <head>
    <meta charset="UTF-8">
    <title>{% block title %}Traceability App{% endblock %}</title>
    <style>
      /* Grundlegende Stile für das Dropdown-Menü */
      .dropdown {
        position: relative;
      }
      .dropdown-content {
        display: none;
        position: absolute;
        right: 0;
        background-color: #f9f9f9;
        min-width: 150px;
        box-shadow: 0px 8px 16px rgba(0,0,0,0.2);
        z-index: 1;
        white-space: nowrap;  /* Verhindert den Zeilenumbruch */
      }
      .dropdown-content a {
        display: block;
        padding: 8px 12px;
        text-decoration: none;
        color: #000;
      }
      .dropdown-content a:hover {
        background-color: #f1f1f1;
      }
    </style>
  </head>
  <body>
    <header>
      <nav>
        <ul style="display: flex; align-items: center; list-style: none;">
          <!-- SETUPS -->
          <li>
            <label for="setup">Setup</label><br>
            <select name="setup" id="setup">
              <option value="">-- Setup auswählen --</option>
              {% for s in setups %}
                <option value="{{ s.id }}">{{ s.name }}</option>
              {% endfor %}
            </select>
          </li>
          <!-- Einstellungen-Dropdown -->
          <li class="dropdown settings" style="margin-left: auto; margin-right:20px; position: relative;">
            <a href="#" id="settingsBtn">Einstellungen</a>
            <div id="settingsDropdown" class="dropdown-content">
              <a href="{{ url_for('manage_users') }}">Benutzer verwalten</a>
              <a href="{{ url_for('manage_projects') }}">Projekte verwalten</a>
              <a href="{{ url_for('manage_machines') }}">Maschinen verwalten</a>
              <a href="{{ url_for('manage_setups') }}">Setups verwalten</a>
            </div>
          </li>
          <li style="margin-right:20px;"><a href="{{ url_for('index') }}">Startseite</a></li>
        </ul>
      </nav>
    </header>
    <div>
      {% with messages = get_flashed_messages() %}
        {% if messages %}
          <ul>
            {% for message in messages %}
              <li>{{ message }}</li>
            {% endfor %}
          </ul>
        {% endif %}
      {% endwith %}
    </div>

    <div>
      {% block content %}{% endblock %}
    </div>

    <script>
      // Toggle-Funktion für das Einstellungen-Dropdown
      document.getElementById("settingsBtn").addEventListener("click", function(e) {
        e.preventDefault();
        var dropdown = document.getElementById("settingsDropdown");
        // Wechsle die Anzeige: block, wenn derzeit none, andernfalls none
        if (dropdown.style.display === "block") {
          dropdown.style.display = "none";
        } else {
          dropdown.style.display = "block";
        }
      });

      // Schließe das Dropdown, wenn irgendwo außerhalb geklickt wird
      window.addEventListener("click", function(e) {
        var settingsBtn = document.getElementById("settingsBtn");
        var dropdown = document.getElementById("settingsDropdown");
        // Wenn das Ziel außerhalb des Einstellungen-Buttons liegt, schließe das Dropdown
        if (!settingsBtn.contains(e.target)) {
          dropdown.style.display = "none";
        }
      });
    </script>
  </body>
</html>
