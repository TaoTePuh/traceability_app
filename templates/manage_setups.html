{% extends 'base.html' %}

{% block title %}Setup-Verwaltung{% endblock %}

{% block content %}
  <h1>Neues Setup anlegen</h1>

  <form method="POST" action="{{ url_for('manage_setups') }}">
    {{ form.hidden_tag() }}
    <p>
      {{ form.benutzer.label }} {{ form.benutzer() }}
    </p>
    <p>
      {{ form.projekt.label }} {{ form.projekt() }}
    </p>
    <p>
      {{ form.maschine.label }} {{ form.maschine() }}
    </p>
    <p>
      {{ form.name.label }} {{ form.name() }}
    </p>
    <p>
      {{ form.bemerkungen.label }} {{ form.bemerkungen() }}
    </p>
    <p>
      {{ form.submit_redirect() }} {{ form.submit_stay() }}
    </p>
  </form>

  <h2>Existierende Setups</h2>
  <ul>
  {% for setup in setups %}
    <li>
      {{ setup.name }}
      ({{ setup.benutzer.username }}, {{ setup.projekt.name }}, {{ setup.maschine.name }})

      <!-- Löschen -->
      <form method="post"
            action="{{ url_for('manage_setups') }}"
            style="display:inline; margin-left:8px;">
        {{ form.csrf_token }}
        <input type="hidden" name="delete_setup_id" value="{{ setup.id }}">
        <button type="submit">Löschen</button>
      </form>

      <!-- Bearbeiten -->
      <form method="get"
            action="{{ url_for('edit_setup', setup_id=setup.id) }}"
            style="display:inline; margin-left:8px;">
        <button type="submit">Bearbeiten</button>
      </form>
    </li>
  {% else %}
    <li>Keine Setups vorhanden.</li>
  {% endfor %}
  </ul>
{% endblock %}
